"use client";

import { useUser } from "@clerk/nextjs";
import { useQuery } from "convex/react";
import { api } from "../../convex/_generated/api";

export default function VulnerabilityScanner() {
  const { user } = useUser();
  const scans = useQuery(api.scans.getScans, user ? { userId: user.id } : "skip");

  return (
    <div className="container mx-auto p-4">
      <h1 className="text-2xl font-bold mb-4">Vulnerability Scanner</h1>
      {/* I will add a form here later if needed, for now just display the scans */}
      <div>
        <h2 className="text-xl font-bold mb-2">Your Scans</h2>
        {scans === undefined && <div>Loading scans...</div>}
        {scans && scans.length === 0 && <div>No scans found.</div>}
        <ul>
          {scans?.map((scan) => (
            <li key={scan._id} className="border-b p-2">
              <p className="font-bold">{scan.url}</p>
              <p>Status: {scan.status}</p>
            </li>
          ))}
        </ul>
      </div>
    </div>
  );
}
